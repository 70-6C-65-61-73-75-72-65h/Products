{"version":3,"sources":["components/Catalog/Product.jsx","components/Catalog/Catalog.jsx"],"names":["Product","productKey","name","price","description","discount","discountEndTime","photo","deleteProduct","isFetching","Preloader","className","styles","productContainer","productHeader","newPrice","console","log","toFixed","calcPrice","imgSmallContainer","src","alt","empty","det","days","Date","getDate","calcDET","operationBlock","to","delete","onClick","compose","withAuthRedirect","connect","state","products","getProducts","useState","firstfetched","setFetched","useEffect","a","fetch","productStyles","catalog","map","product","key"],"mappings":"wLAkEeA,EA9DC,SAAC,GAUV,IATLC,EASI,EATJA,WACAC,EAQI,EARJA,KACAC,EAOI,EAPJA,MACAC,EAMI,EANJA,YACAC,EAKI,EALJA,SACAC,EAII,EAJJA,gBACAC,EAGI,EAHJA,MACAC,EAEI,EAFJA,cAoBA,OAlBI,EADJC,WAmBuB,cAACC,EAAA,EAAD,IAErB,sBAAKC,UAAWC,IAAOC,iBAAvB,UACE,qBAAIF,UAAWC,IAAOE,cAAtB,cAAuCZ,KACvC,sFAAiBE,GAAe,SAChC,6DAbc,WAChB,IAAIW,GAAYZ,EAKhB,OAJIE,IACFU,GAAuB,EAAIV,EAAW,KAExCW,QAAQC,IAAIF,GACLA,EAASG,QAAQ,GAOVC,GAAZ,QACA,qBAAKR,UAAWC,IAAOQ,kBAAvB,SACE,qBAAKC,IAAKd,EAAOe,IAAK,oEAEvBjB,EACC,sBAAKM,UAAS,UAAKC,IAAOP,UAA1B,mDAA+CA,EAA/C,QAEA,qBAAKM,UAAS,UAAKC,IAAOP,SAAZ,YAAwBO,IAAOW,SAE9CjB,EACC,sBAAKK,UAAS,UAAKC,IAAOP,UAA1B,yFAhCU,SAACmB,GACf,IAAIC,EAAO,IAAIC,KAAKF,EAAM,IAAIE,MAAQC,UACtC,MACQ,GAAN,OAAUF,GADPA,EAAO,GAAK,KAAO,IAAQA,EAAO,IAAM,MAAQ,EACnD,kCAEA,mCA4BqBG,CAAQtB,MAG3B,qBAAKK,UAAS,UAAKC,IAAOP,SAAZ,YAAwBO,IAAOW,SAE/C,sBAAKZ,UAAWC,IAAOiB,eAAvB,UACE,8BACE,cAAC,IAAD,CAASC,GAAI,YAAc7B,EAA3B,8FAEF,qBAAKU,UAAWC,IAAOmB,OAAvB,SACE,cAAC,IAAD,CAASD,GAAI,YAAaE,QAAS,kBAAMxB,EAAcP,IAAvD,iE,gCC8BKgC,sBACbC,IACAC,aAPsB,SAACC,GAAD,MAAY,CAClCC,SAAUD,EAAMC,SAASA,SACzB5B,WAAY2B,EAAMC,SAAS5B,cAKF,CAAED,kBAAe8B,kBAF7BL,EArDU,SAAC,GAMnB,IALLK,EAKI,EALJA,YACAD,EAII,EAJJA,SACA7B,EAGI,EAHJA,cACAC,EAEI,EAFJA,WAEI,EAE+B8B,oBAAS,GAFxC,mBAEGC,EAFH,KAEiBC,EAFjB,KAYJ,OATAC,qBAAU,WAKHF,GAJM,uCAAG,sBAAAG,EAAA,6DACZF,GAAW,GADC,SAENH,IAFM,2CAAH,oDAKTM,KAED,CAACJ,EAAcC,EAAYH,IAC1B7B,EAAmB,cAACC,EAAA,EAAD,IAGrB,8BAOE,qBAAKC,UAAWkC,IAAcC,QAA9B,SACGT,EAASU,KAAI,SAACC,GAAD,OACZ,cAAC,EAAD,CAEE/C,WAAY+C,EAAQC,IACpB/C,KAAM8C,EAAQ9C,KACdE,YAAa4C,EAAQ5C,YACrBD,MAAO6C,EAAQ7C,MACfE,SAAU2C,EAAQ3C,SAClBC,gBAAiB0C,EAAQ1C,gBACzBC,MAAOyC,EAAQzC,MACfC,cAAeA,EACfC,WAAYA,GATPuC,EAAQC","file":"static/js/4.fd114637.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport Preloader from \"../Preloader/Preloader\";\r\nimport styles from \"./Product.module.scss\";\r\nconst Product = ({\r\n  productKey,\r\n  name,\r\n  price,\r\n  description,\r\n  discount,\r\n  discountEndTime,\r\n  photo,\r\n  deleteProduct,\r\n  isFetching,\r\n}) => {\r\n  const calcDET = (det) => {\r\n    let days = new Date(det - new Date()).getDate();\r\n    if ((days - 1) % 10 === 0 && !((days - 11) % 100 === 0)) {\r\n      return `${days} сутки`;\r\n    } else {\r\n      return `${days} суток`;\r\n    }\r\n  };\r\n\r\n  const calcPrice = () => {\r\n    let newPrice = +price;\r\n    if (discount) {\r\n      newPrice = newPrice * (1 - discount / 100);\r\n    }\r\n    console.log(newPrice);\r\n    return newPrice.toFixed(2);\r\n  };\r\n  if (isFetching) return <Preloader />;\r\n  return (\r\n    <div className={styles.productContainer}>\r\n      <h3 className={styles.productHeader}> {name}</h3>\r\n      <div> Описание: {description || \"...\"}</div>\r\n      <div>Цена: {calcPrice()} $</div>\r\n      <div className={styles.imgSmallContainer}>\r\n        <img src={photo} alt={\"Фото товара\"} />\r\n      </div>\r\n      {discount ? (\r\n        <div className={`${styles.discount}`}>Скидка: {discount} %</div>\r\n      ) : (\r\n        <div className={`${styles.discount} ${styles.empty}`}></div>\r\n      )}\r\n      {discountEndTime ? (\r\n        <div className={`${styles.discount}`}>\r\n          До конца акции: {calcDET(discountEndTime)}\r\n        </div>\r\n      ) : (\r\n        <div className={`${styles.discount} ${styles.empty}`}></div>\r\n      )}\r\n      <div className={styles.operationBlock}>\r\n        <div>\r\n          <NavLink to={\"/catalog/\" + productKey}>Редактировать</NavLink>\r\n        </div>\r\n        <div className={styles.delete}>\r\n          <NavLink to={\"/catalog/\"} onClick={() => deleteProduct(productKey)}>\r\n            Удалить\r\n          </NavLink>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default Product;\r\n","// import React, { useEffect, useDispatch } from \"react\";\r\n// import {useSelector, shallowEqual} from 'react-redux';\r\n// import { getProducts } from \"../../redux/product-reducer\";\r\n\r\n// export default () => {\r\n//   const dispatch = useDispatch();\r\n//   const { data, fetchDataPending, fetchDataError } = useSelector((state) => ({\r\n//     data: state.data,\r\n//     fetchDataPending: state.fetchDataPending,\r\n//     fetchDataError: state.fetchDataError,\r\n//   }), shallowEqual);\r\n\r\n//   useEffect(() => {\r\n//     if (!data && !fetchDataError && !fetchDataPending) {\r\n//       dispatch(getProducts);\r\n//     }\r\n//   }, [data, fetchDataPending, fetchDataError, dispatch]);\r\n\r\n//   if(!data || fetchDataPending) return 'Loading'\r\n//   if (fetchDataError) return \"Error\";\r\n//   return <>{data}</>\r\n// }\r\n\r\nimport React, { useEffect, useState } from \"react\";\r\n\r\n// import Paginator from \"../Paginator/Paginator\";\r\nimport Product from \"./Product\";\r\nimport { deleteProduct, getProducts } from \"../../redux/product-reducer\";\r\nimport { connect } from \"react-redux\";\r\nimport Preloader from \"../Preloader/Preloader\";\r\nimport withAuthRedirect from \"../HOCS/withAuthRedirect\";\r\nimport { compose } from \"redux\";\r\n\r\nimport productStyles from \"./Product.module.scss\";\r\n\r\nconst CatalogContainer = ({\r\n  getProducts,\r\n  products,\r\n  deleteProduct,\r\n  isFetching,\r\n  // ...props\r\n}) => {\r\n  // debugger;\r\n  const [firstfetched, setFetched] = useState(false);\r\n  useEffect(() => {\r\n    const fetch = async () => {\r\n      setFetched(true);\r\n      await getProducts();\r\n    };\r\n    if (!firstfetched) {\r\n      fetch();\r\n    }\r\n  }, [firstfetched, setFetched, getProducts]);\r\n  if (isFetching) return <Preloader />;\r\n\r\n  return (\r\n    <div>\r\n      {/* <Paginator\r\n        currentPage={currentPage}\r\n        onPageChanged={onPageChanged}\r\n        totalItemsCount={totalUsersCount}\r\n        pageSize={pageSize}\r\n      /> */}\r\n      <div className={productStyles.catalog}>\r\n        {products.map((product) => (\r\n          <Product\r\n            key={product.key}\r\n            productKey={product.key}\r\n            name={product.name}\r\n            description={product.description}\r\n            price={product.price}\r\n            discount={product.discount}\r\n            discountEndTime={product.discountEndTime}\r\n            photo={product.photo}\r\n            deleteProduct={deleteProduct}\r\n            isFetching={isFetching}\r\n          />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => ({\r\n  products: state.products.products,\r\n  isFetching: state.products.isFetching,\r\n});\r\n\r\nexport default compose(\r\n  withAuthRedirect,\r\n  connect(mapStateToProps, { deleteProduct, getProducts })\r\n)(CatalogContainer);\r\n"],"sourceRoot":""}